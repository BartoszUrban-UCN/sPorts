@*
    Partial to:
        - Include the custom JavaScript tab wizard
        - Define the custom added functionality to the next and previous buttons based on the tab
*@

<script>
    //
    //  Custom button loading and setting functionality based on our system
    //
    function fireFunction(n) {
        // Select boat tab
        if (currentTab == 0) {
            if (n == 1) {
                boatId = $("#boat-select").val();
            }
        }
        // Select dates tab
        else if (currentTab == 1) {
            if (n == -1) {
                startDate = null;
                endDate = null;
            }
            else if (n == 1) {
                startDate = $("#start-date").val();
                endDate = $("#end-date").val();

                $.ajax({
                    type: "POST",
                    url: '@Url.Action("CreateMarinaMap", "BookingFlow")',
                    data: { boat: boatId, start: startDate, end: endDate },
                    dataType: "json",
                    success: function (response) {
                        mymap.invalidateSize();
                        renderMarinas(JSON.parse(response));
                    },
                    error: function () { }
                });
            }
        }
        // Pick Marina tab
        else if (currentTab == 2) {
            if (n == -1) {
                marinaId = null;
            }
            else if (n == 1) {
                marinaId = $("#selectedMarina").val();

                $.ajax({
                    type: "POST",
                    url: '@Url.Action("CreateSpotMap", "BookingFlow")',
                    data: { boat: boatId, start: startDate, end: endDate, marina: marinaId },
                    dataType: "json",
                    success: function (response) {
                        mymapspot.invalidateSize();
                        renderSpots(JSON.parse(response));
                    },
                    error: function () { }
                });
            }
        }
        // Pick Spot tab
        else if (currentTab == 3) {
            if (n == -1) {
                spotId = null;
            }
            else if (n == 1) {
                spotId = $("#selectedSpot").val();
            }
        }
        // Booking Lines lineup tab
        else if (currentTab == 4) {
            if (n == -1) {

            }
            else if (n == 1) {

            }
        }

        // Dev purposes method
        outputAllData();
    }

    function selectMarina(marinaId) {
        document.getElementById("selectedMarina").value = marinaId;
        document.getElementById("nextBtn").click();
    }

    function selectSpot(spotId) {
        document.getElementById("selectedSpot").value = spotId;
        document.getElementById("nextBtn").click();
    }

    $(document).ready(function () {
        $.getScript('js/tab_wizard.js');
    });

</script>